<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<title>Demande de site Internet — WebCraft</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet">

<style>
:root{
    --dark:#142C48;
    --blue:#2B5D99;
    --white:#ffffff;
    --light:#f5f8fc;
    --gray:#e0e6f0;
}

*{
    margin:0;
    padding:0;
    box-sizing:border-box;
    font-family:'Poppins',sans-serif;
}

html{
    scroll-behavior:smooth;
}

body{
    background:linear-gradient(180deg,#ffffff,#f5f8fc);
    color:var(--dark);
    overflow-x:hidden;
}

/* HEADER */
header{
    position:fixed;
    top:0;
    width:100%;
    padding:15px 8%;
    display:flex;
    justify-content:space-between;
    align-items:center;
    background:rgba(255,255,255,0.9);
    backdrop-filter:blur(12px);
    z-index:1000;
    transition: all 0.3s ease;
}

header.scrolled{
    background:rgba(255,255,255,1);
    box-shadow:0 5px 20px rgba(0,0,0,0.08);
}

.logo-box img{
    height:50px;
}

/* HERO */
.hero{
    min-height:60vh;
    background:linear-gradient(135deg,var(--dark),var(--blue));
    display:flex;
    align-items:center;
    justify-content:center;
    text-align:center;
    padding:120px 10% 60px;
    color:var(--white);
}

.hero h1{
    font-size:3.2rem;
    font-weight:700;
    margin-bottom:20px;
    animation:fadeInUp 0.8s ease forwards;
}

.hero p{
    font-size:1.1rem;
    max-width:700px;
    margin:auto;
    animation:fadeInUp 1s ease forwards;
}

/* FORM SECTION */
.form-section{
    padding:80px 8%;
    max-width:900px;
    margin:auto;
}

form{
    background:var(--white);
    padding:50px;
    border-radius:25px;
    box-shadow:0 20px 50px rgba(0,0,0,0.08);
}

.form-group{
    margin-bottom:35px;
}

.form-group label{
    display:block;
    font-weight:600;
    margin-bottom:12px;
    color:var(--dark);
    font-size:1.05rem;
}

.required{
    color:#e74c3c;
    margin-left:4px;
}

.form-group input[type="text"],
.form-group input[type="date"],
.form-group textarea{
    width:100%;
    padding:15px 20px;
    border:2px solid var(--gray);
    border-radius:15px;
    font-size:1rem;
    transition: border 0.3s ease;
}

.form-group input:focus,
.form-group textarea:focus{
    outline:none;
    border-color:var(--blue);
}

.form-group textarea{
    resize:vertical;
    min-height:120px;
}

.radio-group, .checkbox-group{
    display:flex;
    flex-direction:column;
    gap:12px;
}

.radio-group label, .checkbox-group label{
    display:flex;
    align-items:center;
    font-weight:400;
    cursor:pointer;
    padding:12px 20px;
    border-radius:12px;
    background:var(--light);
    transition: all 0.3s ease;
}

.radio-group label:hover, .checkbox-group label:hover{
    background:var(--gray);
    transform:translateX(5px);
}

.radio-group input, .checkbox-group input{
    margin-right:12px;
    width:20px;
    height:20px;
    cursor:pointer;
}

.other-input{
    margin-top:10px;
    padding:12px 18px;
    border:2px solid var(--gray);
    border-radius:12px;
    width:100%;
    display:none;
}

.submit-btn{
    width:100%;
    padding:18px;
    border:none;
    border-radius:50px;
    background:linear-gradient(135deg,var(--dark),var(--blue));
    color:white;
    font-weight:600;
    font-size:1.1rem;
    cursor:pointer;
    transition: transform 0.2s ease, box-shadow 0.3s ease;
    margin-top:20px;
}

.submit-btn:hover{
    transform:scale(1.02);
    box-shadow:0 10px 30px rgba(43,93,153,0.3);
}

.submit-btn:disabled{
    opacity:0.6;
    cursor:not-allowed;
}

#formMessage{
    margin-top:25px;
    padding:20px;
    border-radius:15px;
    text-align:center;
    font-weight:600;
    display:none;
}

#formMessage.success{
    background:#d4edda;
    color:#155724;
    border:2px solid #c3e6cb;
}

#formMessage.error{
    background:#f8d7da;
    color:#721c24;
    border:2px solid #f5c6cb;
}

/* FOOTER */
footer{
    background:#081626;
    color:white;
    text-align:center;
    padding:35px;
    font-size:0.95rem;
}

/* Animations */
@keyframes fadeInUp {
    from{opacity:0; transform:translateY(50px);}
    to{opacity:1; transform:translateY(0);}
}

@media (max-width: 768px) {
    .hero h1{
        font-size:2.2rem;
    }
    
    form{
        padding:30px 25px;
    }
    
    .form-section{
        padding:40px 5%;
    }
}
</style>
</head>

<body>

<header>
    <div class="logo-box">
        <img src="Logo.png" alt="WebCraft">
    </div>
</header>

<section class="hero">
    <div>
        <h1>Demande de site Internet</h1>
        <p>Cela permettra au(x) développeur(s) d'avoir plus d'informations sur la difficulté de la conception de votre projet.</p>
    </div>
</section>

<section class="form-section">
    <form id="demandeForm">
        
        <!-- Changed email input type from "email" to "text" and made it small like other fields -->
        <div class="form-group">
            <label>Adresse e-mail :<span class="required">*</span></label>
            <input type="text" name="email" required placeholder="votre.email@exemple.com">
        </div>

        <!-- Updated Age field with new options -->
        <div class="form-group">
            <label>Âge :<span class="required">*</span></label>
            <div class="radio-group">
                <label>
                    <input type="radio" name="age" value="-15 ans" required>
                    -15 ans
                </label>
                <label>
                    <input type="radio" name="age" value="15-18 ans" required>
                    15-18 ans
                </label>
                <label>
                    <input type="radio" name="age" value="+18 ans" required>
                    +18 ans
                </label>
            </div>
        </div>

        <!-- Nom du site/projet field -->
        <div class="form-group">
            <label>Nom du site/projet<span class="required">*</span></label>
            <input type="text" name="nom_projet" required>
        </div>

        <!-- Design with new multiple options -->
        <div class="form-group">
            <label>Design :<span class="required">*</span></label>
            <div class="checkbox-group">
                <label>
                    <input type="checkbox" name="design" value="Simple">
                    Simple
                </label>
                <label>
                    <input type="checkbox" name="design" value="Moderne/Minimaliste">
                    Moderne/Minimaliste
                </label>
                <label>
                    <input type="checkbox" name="design" value="Elaboré">
                    Elaboré
                </label>
                <label>
                    <input type="checkbox" name="design" value="Coloré" id="design_colore">
                    Coloré
                </label>
                <label>
                    <input type="checkbox" name="design" value="Noir et blanc">
                    Noir et blanc
                </label>
            </div>
            <input type="text" id="design_colore_text" class="other-input" placeholder="Précisez les couleurs...">
        </div>

        <!-- New field: Décrivez vos attentes -->
        <div class="form-group">
            <label>Décrivez vos attentes en quelques phrases :<span class="required">*</span></label>
            <textarea name="attentes" required placeholder="Décrivez ce que vous attendez de votre site web..."></textarea>
        </div>

        <!-- Contenu -->
        <div class="form-group">
            <label>Contenu :<span class="required">*</span></label>
            <div class="checkbox-group">
                <label>
                    <input type="checkbox" name="contenu" value="Logo">
                    Logo
                </label>
                <label>
                    <input type="checkbox" name="contenu" value="Images">
                    Images
                </label>
                <label>
                    <input type="checkbox" name="contenu" value="Texte">
                    Texte
                </label>
                <label>
                    <input type="checkbox" name="contenu" value="Autre" id="contenu_autre">
                    Autre
                </label>
            </div>
            <input type="text" id="contenu_autre_text" class="other-input" placeholder="Précisez...">
        </div>

        <!-- Éléments fournis -->
        <div class="form-group">
            <label>Ces éléments nous sont-ils fournis par vous ?<span class="required">*</span></label>
            <div class="radio-group">
                <label>
                    <input type="radio" name="elements_fournis" value="Oui" required>
                    Oui
                </label>
                <label>
                    <input type="radio" name="elements_fournis" value="Non" required>
                    Non
                </label>
            </div>
        </div>

        <!-- Source d'inspiration with conditional field -->
        <div class="form-group">
            <label>Votre idée vient-elle de vous, ou il y a une source d'inspiration ?<span class="required">*</span></label>
            <div class="radio-group">
                <label>
                    <input type="radio" name="source_inspiration" value="Cela vient de moi" required>
                    Cela vient de moi
                </label>
                <label>
                    <input type="radio" name="source_inspiration" value="Cela est inspiré" id="inspiration_oui" required>
                    Cela est inspiré
                </label>
            </div>
            <input type="text" id="inspiration_source" class="other-input" placeholder="De qui/quoi ?">
        </div>

        <!-- Date optimale -->
        <div class="form-group">
            <label>Date optimale de mise en ligne :<span class="required">*</span></label>
            <input type="date" name="date_optimale" required>
        </div>

        <!-- Date maximale -->
        <div class="form-group">
            <label>Date maximale de mise en ligne :<span class="required">*</span></label>
            <input type="date" name="date_maximale" required>
        </div>

        <!-- Commentaires -->
        <div class="form-group">
            <label>Commentaires supplémentaires</label>
            <textarea name="commentaires" placeholder="Ajoutez des informations supplémentaires..."></textarea>
        </div>

        <!-- Pack selection field -->
        <div class="form-group">
            <label>Pack sélectionné :<span class="required">*</span></label>
            <div class="radio-group">
                <label>
                    <input type="radio" name="pack" value="Pack Simple" required>
                    Pack Simple (5-20€)
                </label>
                <label>
                    <input type="radio" name="pack" value="Pack Pro" required>
                    Pack Pro (10-30€)
                </label>
                <label>
                    <input type="radio" name="pack" value="Pack Premium" required>
                    Pack Premium (20-45€)
                </label>
            </div>
        </div>

        <button type="submit" class="submit-btn" id="submitBtn">Envoyer la demande</button>
        
        <div id="formMessage"></div>
    </form>
</section>

<footer>
    © 2026 WebCraft — Tous droits réservés
</footer>

<script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-database-compat.js"></script>
<!-- Added EmailJS SDK -->
<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/@emailjs/browser@3/dist/email.min.js"></script>

<script>
(function(){
    emailjs.init("ge42M3Tp_35vqb8_y"); // Remplacez par votre clé publique EmailJS
})();

const firebaseConfig = {
    apiKey: "AIzaSyCo6gPiD77aN11VnOVJup4Br4D6-CubrWM",
    authDomain: "formulaire-webcraft.firebaseapp.com",
    databaseURL: "https://formulaire-webcraft-default-rtdb.europe-west1.firebasedatabase.app",
    projectId: "formulaire-webcraft",
    storageBucket: "formulaire-webcraft.firebasestorage.app",
    messagingSenderId: "210269846134",
    appId: "1:210269846134:web:d4de743fba2d1b81c97d57"
};

firebase.initializeApp(firebaseConfig);
const database = firebase.database();

const urlParams = new URLSearchParams(window.location.search);
const selectedPack = urlParams.get('pack');
if (selectedPack) {
    const packRadio = document.querySelector(`input[name="pack"][value="${selectedPack}"]`);
    if (packRadio) {
        packRadio.checked = true;
    }
}

document.getElementById('design_colore').addEventListener('change', function() {
    document.getElementById('design_colore_text').style.display = this.checked ? 'block' : 'none';
});

document.getElementById('contenu_autre').addEventListener('change', function() {
    const otherInput = document.getElementById('contenu_autre_text');
    otherInput.style.display = this.checked ? 'block' : 'none';
    if (!this.checked) otherInput.value = '';
});

document.getElementById('inspiration_oui').addEventListener('change', function() {
    document.getElementById('inspiration_source').style.display = this.checked ? 'block' : 'none';
});

document.querySelectorAll('input[name="source_inspiration"]').forEach(radio => {
    radio.addEventListener('change', function() {
        const sourceInput = document.getElementById('inspiration_source');
        if (this.id !== 'inspiration_oui') {
            sourceInput.style.display = 'none';
            sourceInput.value = '';
        }
    });
});

window.addEventListener('scroll', ()=>{
    const header = document.querySelector('header');
    if(window.scrollY > 50) header.classList.add('scrolled');
    else header.classList.remove('scrolled');
});

document.getElementById('demandeForm').addEventListener('submit', function(e) {
    e.preventDefault();
    
    const submitBtn = document.getElementById('submitBtn');
    const formMessage = document.getElementById('formMessage');
    
    const email = document.querySelector('input[name="email"]').value.trim();
    if (!email || !email.includes('@') || !email.includes('.')) {
        formMessage.textContent = '✗ Veuillez entrer une adresse e-mail valide.';
        formMessage.className = 'error';
        formMessage.style.display = 'block';
        return;
    }
    
    const contenuChecked = document.querySelectorAll('input[name="contenu"]:checked');
    if (contenuChecked.length === 0) {
        formMessage.textContent = '✗ Veuillez sélectionner au moins un élément de contenu.';
        formMessage.className = 'error';
        formMessage.style.display = 'block';
        return;
    }
    
    const designChecked = document.querySelectorAll('input[name="design"]:checked');
    if (designChecked.length === 0) {
        formMessage.textContent = '✗ Veuillez sélectionner au moins un type de design.';
        formMessage.className = 'error';
        formMessage.style.display = 'block';
        return;
    }
    
    submitBtn.disabled = true;
    submitBtn.textContent = 'Envoi en cours...';
    
    const formData = new FormData(this);
    
    const contenuValues = Array.from(contenuChecked).map(cb => cb.value);
    const designValues = Array.from(designChecked).map(cb => cb.value);
    
    const data = {
        email: email,
        age: formData.get('age'),
        nom_projet: formData.get('nom_projet'),
        design: designValues,
        design_colore: document.getElementById('design_colore_text').value || '',
        attentes: formData.get('attentes'),
        contenu: contenuValues,
        contenu_autre: document.getElementById('contenu_autre_text').value || '',
        elements_fournis: formData.get('elements_fournis'),
        source_inspiration: formData.get('source_inspiration'),
        inspiration_source: document.getElementById('inspiration_source').value || '',
        date_optimale: formData.get('date_optimale'),
        date_maximale: formData.get('date_maximale'),
        commentaires: formData.get('commentaires') || '',
        pack: formData.get('pack'),
        timestamp: new Date().toISOString(),
        etat: 'En attente',
        montant: '',
        dateMiseEnLigne: '',
        questions: []
    };
    
    console.log('[v0] Email being sent to:', email);
    console.log('[v0] Tracking link will be:', `https://webcraft-fr.vercel.app/suivi.html?id=GENERATED_ID`);
    
    database.ref('demandes').push(data)
        .then((ref) => {
            const demandeId = ref.key;
            const trackingLink = `https://webcraft-fr.vercel.app/suivi.html?id=${demandeId}`;
            
            console.log('[v0] Sending email to:', email);
            console.log('[v0] Tracking link:', trackingLink);
            
            emailjs.send("service_72h9u38", "template_f75ef5v", {
                to_email: email,
                tracking_link: trackingLink,
                nom_projet: data.nom_projet
            })
            .then((response) => {
                console.log('[v0] Email sent successfully:', response);
                formMessage.textContent = '✓ Votre demande a été envoyée avec succès ! Un email avec le lien de suivi vous a été envoyé. Redirection...';
                formMessage.className = 'success';
                formMessage.style.display = 'block';
                
                setTimeout(() => {
                    window.location.href = `suivi.html?id=${demandeId}`;
                }, 3000);
            })
            .catch((emailError) => {
                console.error('[v0] Erreur envoi email:', emailError);
                formMessage.textContent = '✓ Votre demande a été envoyée avec succès ! Redirection...';
                formMessage.className = 'success';
                formMessage.style.display = 'block';
                
                setTimeout(() => {
                    window.location.href = `suivi.html?id=${demandeId}`;
                }, 2000);
            });
        })
        .catch((error) => {
            console.error('[v0] Erreur Firebase:', error);
            formMessage.textContent = '✗ Une erreur est survenue. Veuillez réessayer.';
            formMessage.className = 'error';
            formMessage.style.display = 'block';
            submitBtn.disabled = false;
            submitBtn.textContent = 'Envoyer la demande';
        });
});
</script>

</body>
</html>
